# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Service Worker v4

## üöÄ –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- **SW_VERSION**: `v4`
- **–ö—ç—à–∏**: `static-v4`, `data-v4`, `img-v4`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞**: —Å—Ç–∞—Ä—ã–µ –∫—ç—à–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **HTML/–Ω–∞–≤–∏–≥–∞—Ü–∏—è**: `network-first` (–≤—Å–µ–≥–¥–∞ —Å–≤–µ–∂–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç)
- **JSON –¥–∞–Ω–Ω—ã–µ**: `network-first` (–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: `stale-while-revalidate` (–±—ã—Å—Ç—Ä–æ + –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- **–°—Ç–∞—Ç–∏–∫–∞**: `network-first` (–±–∞–ª–∞–Ω—Å —Å–≤–µ–∂–µ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü–µ—Ä–≤–∏—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
DevTools ‚Üí Application ‚Üí Service Workers ‚Üí Unregister
DevTools ‚Üí Application ‚Üí Clear storage ‚Üí Clear site data

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏:
"Service Worker installing, version: v4"
"Critical resources cached"
"Service Worker activating, version: v4"
"Deleting old cache: [—Å—Ç–∞—Ä—ã–µ –∫—ç—à–∏]"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–µ–π
```bash
DevTools ‚Üí Application ‚Üí Storage ‚Üí Cache Storage
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–æ–ª—å–∫–æ:
- static-v4
- data-v4  
- img-v4
```

### 3. –¢–µ—Å—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

#### HTML (network-first)
```bash
# 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
# 2. –í DevTools ‚Üí Network ‚Üí Disable cache
# 3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: index.html –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–µ –∏–∑ –∫—ç—à–∞)
```

#### JSON (network-first)
```bash
# 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
# 2. –í DevTools ‚Üí Network ‚Üí Disable cache  
# 3. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω "All" –∏–ª–∏ "Likes"
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: products.json –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞
```

#### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (stale-while-revalidate)
```bash
# 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (–∫–∞—Ä—Ç–∏–Ω–∫–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è)
# 2. –í DevTools ‚Üí Network ‚Üí Disable cache
# 3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∏–∑ –∫—ç—à–∞
# 5. –í Network –≤–∏–¥–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```

### 4. –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ò–∑–º–µ–Ω–µ–Ω–∏–µ SW_VERSION
```bash
# 1. –í sw.js –∏–∑–º–µ–Ω–∏—Ç—å SW_VERSION = 'v5'
# 2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª
# 3. –í DevTools ‚Üí Application ‚Üí Service Workers ‚Üí Update
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏:
"Service Worker installing, version: v5"
"Service Worker activating, version: v5"
"Deleting old cache: static-v4"
"Deleting old cache: data-v4"
"Deleting old cache: img-v4"
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
# 1. –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Application ‚Üí Service Workers
# 2. –ü–æ–¥–æ–∂–¥–∞—Ç—å 1 –º–∏–Ω—É—Ç—É (setInterval)
# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è update()
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
```bash
# 1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –≤–∫–ª–∞–¥–∫—É
# 2. –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏: –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è update()
```

### 5. –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### –ê–∫—Ç–∏–≤–∞—Ü–∏—è SW
```bash
# 1. –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏
# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ—Å—Ç "–û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–æ –≤–µ—Ä—Å–∏–∏ v5"
# 3. –¢–æ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å—á–µ–∑–∞—é—Ç —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
```

#### –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```bash
# 1. –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è SW
# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏:
"Service Worker controller changed, reloading page"
# 3. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞
- [ ] –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Å–≤–µ–∂–∏–π `index.html` (network-first)
- [ ] –°—Ç–∞—Ä—ã–µ –∫—ç—à–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ SW
- [ ] –ö–∞—Ä—Ç–∏–Ω–∫–∏ –≥—Ä—É–∑—è—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –∏–∑ –∫—ç—à–∞ –∏ –Ω–µ–≤–∏–¥–∏–º–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
- [ ] –ü—Ä–∏ –≤—ã–ø—É—Å–∫–µ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å `SW_VERSION`
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –æ–∫–Ω–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –¢–æ—Å—Ç—ã –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

### üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### SW –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
```bash
# –†–µ—à–µ–Ω–∏–µ:
DevTools ‚Üí Application ‚Üí Service Workers ‚Üí Update
# –ò–ª–∏
DevTools ‚Üí Application ‚Üí Service Workers ‚Üí Unregister ‚Üí Reload
```

#### –ö—ç—à–∏ –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ sw.js:
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –∫—ç—à–µ–π (static-v4, data-v4, img-v4)
- –§—É–Ω–∫—Ü–∏—è cleanupOldCaches() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ activate
```

#### –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ index.html:
- addEventListener('controllerchange', ...)
- location.reload() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
```

## üìù –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –£—Å–ø–µ—à–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
```
Service Worker installing, version: v4
Critical resources cached
Service Worker activating, version: v4
Deleting old cache: [—Å—Ç–∞—Ä—ã–µ –∫—ç—à–∏]
Service Worker registered successfully
```

### –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```
Service Worker installing, version: v5
Critical resources cached
Service Worker activating, version: v5
Deleting old cache: static-v4
Deleting old cache: data-v4
Deleting old cache: img-v4
Service Worker controller changed, reloading page
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
```
HTML request, using network-first: /index.html
JSON request, using network-first: /data/products.json
Image request, using stale-while-revalidate: /assets/cards/...
Static resource, using network-first: /assets/icons/...
```

## üéØ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
DevTools ‚Üí Application ‚Üí Clear storage ‚Üí Clear site data

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å SW
DevTools ‚Üí Application ‚Üí Service Workers ‚Üí Update

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—ç—à–∏
DevTools ‚Üí Application ‚Üí Storage ‚Üí Cache Storage

# –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å Network
DevTools ‚Üí Network ‚Üí Disable cache

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Console
DevTools ‚Üí Console ‚Üí Filter: "Service Worker"
```
